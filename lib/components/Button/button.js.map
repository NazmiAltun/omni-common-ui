{"version":3,"sources":["components/Button/button.jsx"],"names":["Button","e","props","disabled","function","onClick","ret","_setActiveClassOnClick","onClickActiveClassAddDelay","onClickActiveClassRemoveDelay","setTimeout","_node","classList","add","__active","Promise","_unsetActiveClassIfNonActive","number","active","remove","type","modeClasses","classes","className","_handleButtonClick","c","attrs","children","default","__block","block","__autoWidth","autoWidth","existy","linkHref","linkTo","ButtonLink","newTab","undefined","_renderButton","propTypes","func","string","bool","node","shape"],"mappings":"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","file":"button.js","sourcesContent":["import styles from './style.postcss';\n\nimport React, { PureComponent } from 'react';\nimport classnames from 'classnames';\nimport { Link } from 'react-router';\nimport { Type, validateType } from './type';\nimport is from 'is_js';\nimport PropTypes from 'prop-types';\n\nclass Button extends PureComponent {\n  _handleButtonClick(e) {\n    if (this.props.disabled) {\n      return;\n    }\n\n    if (is.function(this.props.onClick)) {\n      const ret = this.props.onClick(e);\n      this._setActiveClassOnClick(ret);\n    }\n  }\n\n  _setActiveClassOnClick(ret) {\n    const { onClickActiveClassAddDelay, onClickActiveClassRemoveDelay } = this.props;\n\n    // defer this - we don't want to show an active state if something happens immediately\n    setTimeout(async () => {\n      if (! this._node) return;\n      this._node.classList.add(styles.__active);\n      if (ret instanceof Promise) {\n        try { await ret; } catch (e) { /**/ }\n        this._unsetActiveClassIfNonActive();\n      } else {\n        setTimeout(() => {\n          this._unsetActiveClassIfNonActive();\n        }, is.number(onClickActiveClassRemoveDelay) ? onClickActiveClassRemoveDelay : 1000);\n      }\n    }, is.number(onClickActiveClassAddDelay) ? onClickActiveClassAddDelay : 100);\n  }\n\n  _unsetActiveClassIfNonActive() {\n    if (this.props.active) return;\n    if (! this._node) return;\n    this._node.classList.remove(styles.__active);\n  }\n\n  _renderButton(type, modeClasses) {\n    const classes = classnames(type, modeClasses, this.props.className);\n\n    return <button className={classes}\n        disabled={this.props.disabled}\n        onClick={this.props.onClick && ((e) => { this._handleButtonClick(e); })}\n        ref={(c) => { this._node = c; }}\n        {...this.props.attrs || {}}>\n      {this.props.children}\n    </button>;\n  }\n\n  render() {\n    const props = this.props;\n    const type = props.type || Type.default;\n\n    validateType(type);\n\n    const modeClasses = {\n      [styles.__block]: !! props.block,\n      [styles.__autoWidth]: !! props.autoWidth,\n      [styles.__active]: !! props.active,\n    };\n\n    // case: link to URL via `linkHref` OR disabled with `linkTo`\n    if (is.existy(props.linkHref) || (is.existy(props.linkTo) && props.disabled)) {\n      // eslint-disable-next-line no-script-url\n      return <a href={! props.disabled ? props.linkHref : 'javascript:void(0)'}\n          className={classnames(styles.ButtonLink, modeClasses, props.className)}\n          target={props.newTab ? '_blank' : undefined}\n          onClick={() => { this._setActiveClassOnClick(); }}>\n        {this._renderButton(type, modeClasses)}\n      </a>;\n    }\n\n    // case: link to route via `linkTo`\n    if (is.existy(props.linkTo)) {\n      return <Link to={props.linkTo}\n          draggable={false}\n          className={classnames(styles.ButtonLink, modeClasses, props.className)}\n          onClick={() => { this._setActiveClassOnClick(); }}>\n        {this._renderButton(type, modeClasses)}\n      </Link>;\n    }\n\n    return this._renderButton(type, modeClasses);\n  }\n}\n\nButton.propTypes = {\n  onClick: PropTypes.func,\n  type: PropTypes.string,\n  disabled: PropTypes.bool,\n  newTab: PropTypes.bool,\n  children: PropTypes.node,\n  linkTo: PropTypes.string,\n  linkHref: PropTypes.string,\n  block: PropTypes.bool,\n  autoWidth: PropTypes.bool,\n  active: PropTypes.bool,\n  className: PropTypes.string,\n  attrs: PropTypes.shape({\n    type: PropTypes.string,\n  }),\n  onClickActiveClassAddDelay: PropTypes.number,  // default: 100ms\n  onClickActiveClassRemoveDelay: PropTypes.number,  // default: 1000ms\n};\n\nexport default Button;\n"]}