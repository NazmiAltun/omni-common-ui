{"version":3,"sources":["containers/SingleSignOn/IdleTimeoutHandler.jsx"],"names":["IdleTimeoutHandler","not","number","get","timer","_signOut","bind","_invokeIdleTimer","window","document","addEventListener","cancel","removeEventListener","debug","invoke","props","router","setRouteLeaveHook","_getCurrentRoute","forceSignOutRedirect","routes","length","children","propTypes","node","any","isRequired","array"],"mappings":";;;;;;;;AAAA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;;;;;IAEqBA,kB;;;;;;;;;;;yCACE;AACnB,UAAI,gBAAGC,GAAH,CAAOC,MAAP,CAAc,iBAAOC,GAAP,CAAW,oBAAX,CAAd,CAAJ,EAAqD;AACnD,eAAO,KAAP;AACD;;AAED,WAAKC,KAAL,GAAa,qBAAb;;AAEA,WAAKC,QAAL,GAAgB,KAAKA,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAAhB;AACA,WAAKC,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBD,IAAtB,CAA2B,IAA3B,CAAxB;;AAEA,WAAKC,gBAAL;AACAC,aAAOC,QAAP,CAAgBC,gBAAhB,CAAiC,OAAjC,EAA0C,KAAKH,gBAA/C;AACAC,aAAOC,QAAP,CAAgBC,gBAAhB,CAAiC,UAAjC,EAA6C,KAAKH,gBAAlD;AACD;;;2CAEsB;AACrB,UAAI,gBAAGN,GAAH,CAAOC,MAAP,CAAc,iBAAOC,GAAP,CAAW,oBAAX,CAAd,CAAJ,EAAqD;AACnD,eAAO,KAAP;AACD;;AAED,WAAKC,KAAL,CAAWO,MAAX;AACAH,aAAOC,QAAP,CAAgBG,mBAAhB,CAAoC,OAApC,EAA6C,KAAKL,gBAAlD;AACAC,aAAOC,QAAP,CAAgBG,mBAAhB,CAAoC,UAApC,EAAgD,KAAKL,gBAArD;AACD;;;uCAEkB;AACjB,oBAAIM,KAAJ,CAAU,6CAAV;AACA,WAAKT,KAAL,CAAWU,MAAX,CAAkB,KAAKT,QAAvB,EAAiC,iBAAOF,GAAP,CAAW,oBAAX,IAAmC,IAApE;AACD;;;+BAEU;AACT,oBAAIU,KAAJ,CAAU,qCAAV;AACA;AACA,UAAI,KAAKE,KAAL,CAAWC,MAAf,EAAuB;AACrB,aAAKD,KAAL,CAAWC,MAAX,CAAkBC,iBAAlB,CAAoC,KAAKC,gBAAL,EAApC,EAA6D,IAA7D;AACD;AACD,6CAAoBC,oBAApB;AACD;;;uCAEkB;AACjB,aAAO,KAAKJ,KAAL,CAAWK,MAAX,CAAkB,KAAKL,KAAL,CAAWK,MAAX,CAAkBC,MAAlB,GAA2B,CAA7C,CAAP;AACD;;;6BAEQ;AACP,aAAO,KAAKN,KAAL,CAAWO,QAAlB;AACD;;;;;;kBA9CkBtB,kB;;;AAiDrBA,mBAAmBuB,SAAnB,GAA+B;AAC7BD,YAAU,oBAAUE,IADS;AAE7BR,UAAQ,oBAAUS,GAAV,CAAcC,UAFO;AAG7BN,UAAQ,oBAAUO,KAAV,CAAgBD;AAHK,CAA/B","file":"IdleTimeoutHandler.js","sourcesContent":["import { PureComponent } from 'react';\nimport Timer from './Timer';\nimport { createUserManager } from 'data/SingleSignOn';\nimport log from 'domain/log';\nimport Config from 'domain/Config';\nimport is from 'is_js';\nimport PropTypes from 'prop-types';\n\nexport default class IdleTimeoutHandler extends PureComponent {\n  componentWillMount() {\n    if (is.not.number(Config.get('autoSignOutTimeout'))) {\n      return false;\n    }\n\n    this.timer = new Timer();\n\n    this._signOut = this._signOut.bind(this);\n    this._invokeIdleTimer = this._invokeIdleTimer.bind(this);\n\n    this._invokeIdleTimer();\n    window.document.addEventListener('click', this._invokeIdleTimer);\n    window.document.addEventListener('keypress', this._invokeIdleTimer);\n  }\n\n  componentWillUnmount() {\n    if (is.not.number(Config.get('autoSignOutTimeout'))) {\n      return false;\n    }\n\n    this.timer.cancel();\n    window.document.removeEventListener('click', this._invokeIdleTimer);\n    window.document.removeEventListener('keypress', this._invokeIdleTimer);\n  }\n\n  _invokeIdleTimer() {\n    log.debug('IdleTimeoutHandler - Will start a new timer');\n    this.timer.invoke(this._signOut, Config.get('autoSignOutTimeout') * 1000);\n  }\n\n  _signOut() {\n    log.debug('IdleTimeoutHandler - Will sign out!');\n    // SignOut should not be with the route hook.\n    if (this.props.router) {\n      this.props.router.setRouteLeaveHook(this._getCurrentRoute(), null);\n    }\n    createUserManager().forceSignOutRedirect();\n  }\n\n  _getCurrentRoute() {\n    return this.props.routes[this.props.routes.length - 1];\n  }\n\n  render() {\n    return this.props.children;\n  }\n}\n\nIdleTimeoutHandler.propTypes = {\n  children: PropTypes.node,\n  router: PropTypes.any.isRequired,\n  routes: PropTypes.array.isRequired,\n};\n"]}