{"version":3,"sources":["containers/Sidebar/component.jsx"],"names":["Sidebar","props","routes","reduce","reduction","value","not","object","sidebar","merge","filter","item","isEmpty","sortBy","get","colorConfig","findLast","route","string","sidebarColor","undefined","_items","_getItems","_color","_getColor","_onClickedOutside","bind","_onPageScrolled","_setUp","_removeClickOutsideEvents","_removePageSrolledEvents","expanded","_addClickOutsideEvents","_addPageSrolledEvents","document","body","addEventListener","removeEventListener","evt","_node","contains","target","_contract","expandedNode","querySelector","Sidebar_expanded","style","paddingTop","headerSize","scrollTop","function","onExpand","onCollapse","pathname","location","backgroundColor","Sidebar_close","e","Sidebar_close_button","Sidebar_close_button_icon","map","config","link","Sidebar_item","toArray","size","onClickBar","_expand","c","_renderExpanded","propTypes","array","isRequired","shape","bool","func"],"mappings":"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","file":"component.js","sourcesContent":["import styles from './style.postcss';\n\nimport React, { Component } from 'react';\nimport Link from './Link';\nimport is from 'is_js';\nimport { OrderedMap, List, Map } from 'immutable';\nimport CSSTransitionGroup from 'react-transition-group/CSSTransitionGroup';\nimport classnames from 'classnames';\nimport testClass from 'domain/testClass';\nimport PropTypes from 'prop-types';\nimport Icon from 'components/Icon';\n\nclass Sidebar extends Component {\n  static _getItems(props) {\n    const { routes } = props;\n    return new List(routes).reduce((reduction, value) => {\n      if (is.not.object(value.sidebar)) {\n        return reduction;\n      }\n\n      return reduction.merge(value.sidebar);\n    }, new OrderedMap())\n        .filter((item) => item instanceof Map && ! item.isEmpty())\n        .sortBy((item) => item.get('order'));\n  }\n\n  static _getColor(props) {\n    const { routes } = props;\n    const colorConfig = new List(routes).findLast((route) => is.string(route.sidebarColor));\n    if (! colorConfig) {\n      return undefined;\n    }\n\n    return colorConfig.sidebarColor;\n  }\n\n  constructor(props) {\n    super(props);\n    this._items = Sidebar._getItems(props);\n    this._color = Sidebar._getColor(props);\n    this._onClickedOutside = this._onClickedOutside.bind(this);\n    this._onPageScrolled = this._onPageScrolled.bind(this);\n  }\n\n  componentDidMount() {\n    this._setUp(this.props);\n  }\n\n  componentWillUpdate(props) {\n    this._items = Sidebar._getItems(props);\n    this._color = Sidebar._getColor(props);\n    this._setUp(props);\n  }\n\n  componentDidUpdate() {\n    this._onPageScrolled();\n  }\n\n  componentWillUnmount() {\n    this._removeClickOutsideEvents();\n    this._removePageSrolledEvents();\n  }\n\n  _setUp(props) {\n    if (props.expanded === true) {\n      this._addClickOutsideEvents();\n      this._addPageSrolledEvents();\n    } else {\n      this._removeClickOutsideEvents();\n      this._removePageSrolledEvents();\n    }\n  }\n\n  _addClickOutsideEvents() {\n    document.body.addEventListener('click', this._onClickedOutside);\n    document.body.addEventListener('touchstart', this._onClickedOutside);\n  }\n\n  _removeClickOutsideEvents() {\n    document.body.removeEventListener('click', this._onClickedOutside);\n    document.body.removeEventListener('touchstart', this._onClickedOutside);\n  }\n\n  _addPageSrolledEvents() {\n    document.addEventListener('scroll', this._onPageScrolled);\n    document.addEventListener('wheel', this._onPageScrolled);\n  }\n\n  _removePageSrolledEvents() {\n    document.removeEventListener('scroll', this._onPageScrolled);\n    document.removeEventListener('wheel', this._onPageScrolled);\n  }\n\n  _onClickedOutside(evt) {\n    if (this._node.contains(evt.target)) {\n      return;\n    }\n\n    this._contract(evt);\n  }\n\n  _onPageScrolled() {\n    const expandedNode = this._node.querySelector(`.${styles.Sidebar_expanded}`);\n    if (! expandedNode) {\n      return;\n    }\n\n    expandedNode.style.paddingTop = `calc(${styles.headerSize} - ${document.body.scrollTop}px)`;\n  }\n\n  _expand(evt) {\n    is.function(this.props.onExpand) && this.props.onExpand(evt);\n  }\n\n  _contract(evt) {\n    is.function(this.props.onCollapse) && this.props.onCollapse(evt);\n  }\n\n  _renderExpanded() {\n    const { location: { pathname } } = this.props;\n    return <div className={classnames(styles.Sidebar_expanded, testClass('sidebar-expanded'))}\n        style={{ backgroundColor: this._color }}>\n      <div className={styles.Sidebar_close}>\n        <button onClick={(e) => this._contract(e)}\n            className={classnames(styles.Sidebar_close_button, testClass('sidebar-close'))}>\n          <Icon className={styles.Sidebar_close_button_icon} id=\"close\" />\n        </button>\n      </div>\n      {\n        this._items.map((config, link) => <Link key={link} to={link} currentPath={pathname}>\n          <button className={styles.Sidebar_item}>{config.get('text')}</button>\n        </Link>).toArray()\n      }\n    </div>;\n  }\n\n  render() {\n    if (this._items.size <= 0) {\n      return null;\n    }\n\n    const { expanded } = this.props;\n    const onClickBar = expanded === true ? undefined : (e) => this._expand(e);\n    return <div className={classnames(styles.Sidebar, testClass('sidebar'))}\n        onClick={onClickBar}\n        style={{ backgroundColor: this._color }}\n        ref={(c) => { this._node = c; }}>\n      <CSSTransitionGroup transitionName=\"sidebar\">\n        {expanded === true && this._renderExpanded()}\n      </CSSTransitionGroup>\n    </div>;\n  }\n}\n\nSidebar.propTypes = {\n  routes: PropTypes.array.isRequired,\n  location: PropTypes.shape({ pathname: PropTypes.string.isRequired }).isRequired,\n  expanded: PropTypes.bool,\n  onCollapse: PropTypes.func,\n  onExpand: PropTypes.func,\n};\n\nexport default Sidebar;\n"]}